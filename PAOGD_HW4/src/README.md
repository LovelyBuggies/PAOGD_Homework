## åˆ©ç”¨OpenGLè®¾è®¡è´ªåƒè›‡æ¸¸æˆ

---

### æ¸¸æˆç®€ä»‹
ğŸå…ˆç”Ÿåä¸ªè´ªå©ªçš„åƒè´§ã€‚ç”Ÿæ´»åœ¨ä¸›æ—ä¸­çš„ä»–å¦„å›¾å–å…‰æ‰€æœ‰çš„æœæ±æ¥è®©è‡ªå·±ç”Ÿé•¿ã€‚ä½†æ˜¯"äººå¿ƒä¸è¶³è›‡åè±¡â€ï¼Œä»–å¾€å¾€ä¼šè¯¯é£Ÿè‡ªå·±æˆ–æ’ä¸ŠçŸ³å¤´ã€‚æ¸¸æˆä¸­ï¼Œç©å®¶æ§åˆ¶è´ªåƒè›‡åœ¨æ¸¸æˆåŒºåŸŸé‡Œé©°éª‹ï¼Œé¿å…ç¢°åˆ°è‡ªå·±æˆ–éšœç¢ç‰©ï¼Œå°½å¯èƒ½åœ°åƒæ›´å¤šçš„é£Ÿç‰©ä»¥ç”Ÿé•¿ï¼

**æ¸¸æˆç©æ³•**ï¼š

- WASDæ§åˆ¶è›‡çš„ç§»åŠ¨
- æ¸¸æˆå¼€å§‹ï¼Œæ¯éš”ä¸€å®šæ—¶é—´ä¼šåœ¨åœ°å›¾ç©ºé—²ä½ç½®åˆ·æ–°ä¸€ä¸ªé£Ÿç‰©ï¼Œè›‡è§¦ç¢°åˆ°é£Ÿç‰©åé£Ÿç‰©æ¶ˆå¤±ï¼Œè›‡ä¼šå¢åŠ ä¸€ä¸ªå•ä½çš„é•¿åº¦
- å½“è›‡è§¦ç¢°åˆ°è‡ªå·±æˆ–è€…éšœç¢ç‰©ï¼Œåˆ™æ¸¸æˆå¤±è´¥
- å½“è›‡æ¥è§¦åˆ°åœ°å›¾è¾¹ç•Œï¼Œè›‡ä¼šåœ¨åœ°å›¾å¦ä¸€ç«¯é‡æ–°è¿›å…¥åœ°å›¾



---

### å¼€å‘ç¯å¢ƒ

- OpenGL3
- GLFW
- GLAD



---

### æç¤º

1. ä¸»ç¨‹åºï¼šç¨‹åºçª—å£ç®¡ç†ã€æŒ‰é”®å“åº”ã€æ¸¸æˆå¯¹è±¡ç®¡ç†ã€çŠ¶æ€ä¼ é€’ï¼ˆç»´æŠ¤ç¨‹åºçŠ¶æ€ï¼‰
![image](http://upload-images.jianshu.io/upload_images/3220531-6ac881fc4ac87a8e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
3. ç²¾çµç±»ï¼šç»´æŠ¤ç²¾çµçŠ¶æ€ï¼Œæä¾›æ¸²æŸ“æ¥å£
![image](http://upload-images.jianshu.io/upload_images/3220531-15276c545cbe2b83.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
3. å·¥å…·ç±»ï¼šç®¡ç†ç€è‰²å™¨ã€çº¹ç†çš„åŠ è½½ï¼ˆä¹Ÿæœ‰äººä¹ æƒ¯æŠŠè¿™éƒ¨åˆ†ä»£ç è€¦åˆåˆ°ç²¾çµç±»ä¸­!ï¼‰
![image](http://upload-images.jianshu.io/upload_images/3220531-317db2b4a037f5dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
2. æ¸¸æˆç±»ï¼šç»´æŠ¤æ¸¸æˆçŠ¶æ€ï¼Œæä¾›æ›´æ–°çŠ¶æ€çš„æ¥å£ä¾›ä¸»ç¨‹åºè°ƒç”¨ï¼Œè¿›è¡Œç¢°æ’æ£€æµ‹ç­‰
![image](http://upload-images.jianshu.io/upload_images/3220531-57e3ec55b96508d1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

è™½ç„¶ä¸€ä¸ªå®Œæ•´æ¸¸æˆåŒ…å«çš„å†…å®¹è¿œä¸æ­¢ä¸Šé¢æåˆ°çš„å››ç‚¹ï¼Œå®ç°äº†è¿™äº›å†…å®¹ï¼Œæ¸¸æˆçš„ä¸»ä½“éƒ¨åˆ†å°±å¤§è‡´å®Œæˆäº†



---

### ç›®æ ‡
1. å®Œæˆè´ªåƒè›‡æ¸¸æˆçš„æ¡†æ¶æ­å»ºã€‚
2. å®Œæˆè›‡ä»¥åŠé£Ÿç‰©çš„ **3D** ç²¾çµåŠ è½½å’Œæ¸²æŸ“ï¼Œå…¶ä¸­æ¨¡å‹å¯ä»¥ç”¨ç®€å•çš„çº¯è‰²å‡ ä½•æ¨¡å‹å®ç°å¦‚ç«‹æ–¹ä½“ã€çƒä½“ï¼›æˆ–è€…ç½‘ä¸Šä¸‹è½½åˆé€‚çš„3Dæ¨¡å‹å¦‚[Apple-Poly](https://poly.google.com/view/5hRReRDr0v4)ã€[Snake-Poly](https://poly.google.com/view/2ovwPNrRijL)ã€‚
3. å®ç°è›‡çš„æ§åˆ¶ã€‚
4. è›‡çš„ç¢°æ’æ£€æµ‹ä¸å“åº”ã€‚



---

### ç¯å¢ƒæ­å»º

è¿™ä¸ªé¡¹ç›®ä¸»è¦æ˜¯ç”¨Visual Studioæ­å»ºçš„ç¯å¢ƒã€‚å¦‚ä½•åœ¨VSä¸Šæ­å»ºopenGLå¼€å‘ç¯å¢ƒåœ¨æ­¤ä¸å†èµ˜è¿°ï¼Œä¸»è¦å‚è€ƒè¿™ä¸ªé“¾æ¥ï¼š[https://learnopengl-cn.github.io/01%20Getting%20started/02%20Creating%20a%20window/](https://learnopengl-cn.github.io/01 Getting started/02 Creating a window/)



---

### å®ç°

#### â˜… è›‡èº«å—

> å—ç±»çš„å®šä¹‰åœ¨Block.hæ–‡ä»¶ä¸­ï¼Œå®ç°åœ¨Block.cppæ–‡ä»¶ä¸­ã€‚

`Class Block`ä¸­ï¼Œç§æœ‰æˆå‘˜æœ‰ï¼š**ä½ç½®**ã€**å¤§å°**ã€**é¢œè‰²**ã€‚

`Class Block`ä¸­ï¼Œå…¬æœ‰æˆå‘˜å¦‚ä¸‹ï¼š

- **æ„é€ å‡½æ•°**ï¼šåˆå§‹åŒ–å—ä½ç½®å’Œå—å¤§å°ã€‚
- **set*()**ï¼šè®¾ç½®å‡½æ•°ã€‚
- **get*()**ï¼šè·å–å‡½æ•°ã€‚

#### â˜… æœèŒ¶

> æœèŒ¶ç±»çš„å®šä¹‰åœ¨Fruit.hæ–‡ä»¶ä¸­ï¼Œå®ç°åœ¨Fruit.cppæ–‡ä»¶ä¸­ã€‚

`Class Fruit`ä¸­ï¼Œç§æœ‰æˆå‘˜æœ‰ï¼š**ä½ç½®**ã€**å¤§å°**ã€**é¢œè‰²**ã€**è§’åº¦**ã€‚å…¶ä¸­è§’åº¦ç”¨æ¥æ§åˆ¶æ—‹è½¬ã€‚

`Class Fruit`ä¸­ï¼Œå…¬æœ‰æˆå‘˜å¦‚ä¸‹ï¼š

- **æ„é€ å‡½æ•°**ï¼šåˆå§‹åŒ–æœèŒ¶ä½ç½®å’ŒæœèŒ¶å¤§å°ã€‚
- **set*()**ï¼šè®¾ç½®å‡½æ•°ã€‚
- **get*()**ï¼šè·å–å‡½æ•°ã€‚

#### â˜… ç£çŸ³

> ç£çŸ³ç±»çš„å®šä¹‰åœ¨Stone.hæ–‡ä»¶ä¸­ï¼Œå®ç°åœ¨Stone.cppæ–‡ä»¶ä¸­ã€‚

`Class Stone`ä¸­ï¼Œç§æœ‰æˆå‘˜æœ‰ï¼š**ä½ç½®**ã€**å¤§å°**ã€**é¢œè‰²**ã€‚

`Class Stone`ä¸­ï¼Œå…¬æœ‰æˆå‘˜å¦‚ä¸‹ï¼š

- **æ„é€ å‡½æ•°**ï¼šåˆå§‹åŒ–çŸ³å¤´ä½ç½®å’ŒçŸ³å¤´å¤§å°ã€‚
- **set*()**ï¼šè®¾ç½®å‡½æ•°ã€‚
- **get*()**ï¼šè·å–å‡½æ•°ã€‚

#### â˜… è´ªåƒè›‡

> è›‡ç±»çš„å®šä¹‰åœ¨Snake.hæ–‡ä»¶ä¸­ï¼Œå®ç°åœ¨Snake.cppæ–‡ä»¶ä¸­ã€‚

`Class Snake`ä¸­ï¼Œç§æœ‰æˆå‘˜å¦‚ä¸‹ï¼š

-  **currentDirection**ï¼šè®°å½•å½“å‰ğŸç§»åŠ¨çš„æ–¹å‘ï¼›
- **isUpdated**ï¼šğŸæ˜¯å¦æ›´æ–°è¿‡äº†ï¼›
- **score**ï¼šæ¸¸æˆå¾—åˆ†ã€‚

`Class Snake`ä¸­ï¼Œå…¬æœ‰æˆå‘˜å¦‚ä¸‹ï¼š

- **æ„é€ å‡½æ•°**ï¼šåˆå§‹åŒ–çš„æ—¶å€™ï¼Œè›‡å¤´è¢«å®šä¹‰ä¸ºé»„è‰²ï¼Œè›‡çš„ç§»åŠ¨æ–¹å‘å‘å·¦ã€‚
- **draw()**ï¼šç”»å‡ºè›‡çš„æ„æˆcomponentsï¼ŒåŒ…å«å¤šä¸ªå—ç±»é“¾è¡¨ã€‚
- **move(Direction direction)**ï¼šå®šä¹‰è›‡çš„åŸºæœ¬ç§»åŠ¨ã€‚è›‡çš„ç§»åŠ¨é€Ÿåº¦ speed éšç€åˆ†æ•°å¢é•¿é€æ¸å˜å¿«ï¼Œæ¸¸æˆéš¾åº¦å¢é«˜ã€‚
- **pushSnake()**ï¼šå—ç›¸è¿ï¼Œæ„æˆè›‡ã€‚
- **update(Fruit* fruit, Stone* stones[])**ï¼šæ›´æ–°ğŸçš„çŠ¶æ€ï¼ŒåŒ…å«ç¢°æ’æ£€æµ‹ï¼ˆæœèŒ¶å’ŒçŸ³å¤´ï¼‰ï¼Œæ¯0.1ç§’æ£€æŸ¥ä¸€ä¸‹ã€‚
- **collisionDetection(Fruit* fruit, Stone* stones[])**ï¼šç¢°æ’æ£€æŸ¥ã€‚
  - å–äº†æœèŒ¶ï¼Œæ ¹æ®éš¾åº¦åŠ åˆ†ï¼š
    - éš¾åº¦è¶Šé«˜ï¼ŒåŠ åˆ†è¶Šå¤šï¼›
    - äº§ç”Ÿæ–°å£ï¼ˆyanï¼‰å‘³ï¼ˆseï¼‰çš„æœèŒ¶ï¼ˆ*åˆ¤æ–­æ¡ä»¶ï¼šä¸èƒ½åœ¨**è›‡èº«ä¸Š**æˆ–è€…**ç£çŸ³ä¸Š**äº§ç”Ÿæ–°çš„æœèŒ¶*ï¼‰ï¼›
    - æ ¹æ®éš¾åº¦å˜é•¿ï¼Œéš¾åº¦è¶Šé«˜å˜é•¿è¶Šå¤šã€‚
  - ç›´é¢çŸ³å¤´ï¼Œsmash to piece! ç²‰èº«ç¢éª¨ï¼å¼¹çª—éšè—ã€‚
- **addBlock()**ï¼šå–äº†æœèŒ¶ï¼Œä¼šé•¿èº«ä½“ã€‚åŒæ ·ï¼Œéš¾åº¦è¶Šé«˜ï¼Œé•¿èº«ä½“ä¼šè¶Šå¿«ï¼ŒåŒæ—¶é¢ä¸´ç€æ›´åŠ å±é™©çš„å±€é¢ã€‚

#### â˜… ç”»å›¾

> ç”»å›¾ç±»çš„å®šä¹‰åœ¨Draw.hæ–‡ä»¶ä¸­ï¼Œå®ç°åœ¨Draw.cppæ–‡ä»¶ä¸­ã€‚

`Class Draw`ä¸­ï¼Œå®šä¹‰äº†ä¸¤ä¸ªå‡½æ•°ï¼š

- **buildDLs()**ï¼šç”» cube çš„ listï¼Œæ‰‹åŠ¨å®šä¹‰ `cube`ã€‚
- **drawGrid()**ï¼šç”»ç½‘æ ¼èƒŒæ™¯
  - GL_QUADSï¼šç«‹ä½“å››è¾¹å½¢ä½œä¸ºè¾¹ç•Œä¿®é¥°ï¼›
  - GL_LINESï¼šæ ¼å­çº¿å’Œä¿®é¥°è¾¹çº¿ã€‚

#### â˜… ä¸»æ–‡ä»¶

ç¯å…‰å¤„ç†ã€‚

```cpp
GLfloat lightAmbient[] = { 0.5,0.5,0.5,1 };
GLfloat lightDiffuse[] = { 1,1,1,1 };
GLfloat lightPosition[] = { 0,3,0 };
```

ç‰©ä½“åˆ›å»ºã€‚

``` cpp
Fruit* fruit = new Fruit(1, 1);
Snake* snake = new Snake(0, 0, 3);
Stone* stone = new Stone(-3,-3);
Stone* stones[2] = { stone };
```

é‡å®šä¹‰çª—å£å¤§å°ã€è§¦å‘äº‹ä»¶ã€‚

```cpp
resize(int w, int h);
keyEvents(unsigned char key, int x, int y);
mouseEvents(int button, int dir, int x, int y);
```

åˆå§‹åŒ–GLã€‚

```cpp
void initGL(void) {
	glShadeModel(GL_SMOOTH);
	glEnable(GL_DEPTH_TEST);
	glLightfv(GL_LIGHT1, GL_AMBIENT, lightAmbient);
	glLightfv(GL_LIGHT1, GL_DIFFUSE, lightDiffuse);
	glLightfv(GL_LIGHT1, GL_POSITION, lightPosition);
	glEnable(GL_LIGHT1);
	glEnable(GL_LIGHTING);
	glEnable(GL_COLOR_MATERIAL);
	glEnable(GL_TEXTURE_2D);
}
```

ç”»æ¸¸æˆç³»ç»Ÿå›¾ã€‚

```cpp
draw(){
  Draw d;
	d.drawGrid();
	snake->draw();
	stone1->draw();
	fruit->draw();
}
```

mainå‡½æ•°çš„æµç¨‹å¦‚ä¸‹ï¼š

1. åˆå§‹åŒ–ï¼ˆåŒ…æ‹¬åˆ›å»ºçª—å£å’Œæ˜¾ç¤ºæ¨¡å¼ï¼‰ï¼›
2. ç”»æ¸¸æˆç³»ç»Ÿå›¾ï¼›
3. äº‹ä»¶æ”¶é›†å’Œåº”ç­”ï¼›
4. ä¸æ–­å¾ªç¯ã€‚

```cpp
int main(int argc, char **argv) {
	srand(time(NULL));
	glutInit(&argc, argv);
	glutInitWindowPosition(-1, -1);
	glutInitWindowSize(800, 600);
	glutInitDisplayMode(GLUT_RGBA | GLUT_DEPTH | GLUT_DOUBLE);
	glutCreateWindow("Greedy Snake");

	initGL();
	Draw d;
	d.buildDLs();

	glutDisplayFunc(draw);
	glutIdleFunc(draw);
	glutReshapeFunc(resize);
	glutKeyboardFunc(keyEvents);
	glutSpecialFunc(specialKeys);
	glutMouseFunc(mouseEvents);

	glutMainLoop();

	return 1;
}
```

è‡³æ­¤ï¼Œæˆ‘ä»¬è´ªåƒè›‡å°æ¸¸æˆå°±å®ç°å®Œäº†ã€‚ğŸ‰



---

### æ•ˆæœå±•ç¤º

#### æ¸¸æˆè§†é¢‘

ç”±äºæ–‡ç¨¿çš„é™åˆ¶ï¼Œç¾å¥½çš„æ¸¸æˆä½“éªŒ ğŸ® æ— æ³•å±•ç¤ºå‡ºæ¥ï¼Œæ‰€ä»¥æˆ‘å°†æ¸¸æˆçš„è§†é¢‘æ”¾åˆ°äº† Youtube æ²¹ç®¡ä¸Šã€‚

- https://www.youtube.com/watch?v=QntNhYvB-5o â€”â€” æ¸¸æˆèŠ‚é€‰ 1
- https://www.youtube.com/watch?v=UcTRJ33ivMs â€”â€” æ¸¸æˆèŠ‚é€‰ 2
- https://www.youtube.com/watch?v=OrmnSZH6kkI â€”â€” æ¸¸æˆèŠ‚é€‰ 3
- https://www.youtube.com/watch?v=cXnobgYxbBs â€”â€” å› é£Ÿå·±è€Œæ­»
- https://www.youtube.com/watch?v=3mbC-D8uZ5c â€”â€” å› æ’å£è€Œäº¡

#### æ¸¸æˆæˆªå›¾

![image.png](https://upload-images.jianshu.io/upload_images/3220531-311692c2d53df424.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

![image.png](https://upload-images.jianshu.io/upload_images/3220531-58e2d7b7459503bc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

![pic1.gif](https://upload-images.jianshu.io/upload_images/3220531-d3ad2e6026293a83.gif?imageMogr2/auto-orient/strip)

![pic2.gif](https://upload-images.jianshu.io/upload_images/3220531-6e62c44e531b4917.gif?imageMogr2/auto-orient/strip)

![pic3](https://upload-images.jianshu.io/upload_images/3220531-6886abb459d37e66.gif?imageMogr2/auto-orient/strip)

![pic4](https://upload-images.jianshu.io/upload_images/3220531-69c2d2344a3dd1d4.gif?imageMogr2/auto-orient/strip)





---

### å‚è€ƒ

1. [OpenGLæ¸¸æˆ-æ¡†æ¶è®¾è®¡](https://learnopengl.com/In-Practice/2D-Game/Setting-up)
2. [OpenGLæ¸¸æˆ-ç²¾çµæ¸²æŸ“](https://learnopengl.com/In-Practice/2D-Game/Rendering-Sprites)
3. [OpenGLæ¸¸æˆ-ç¢°æ’æ£€æµ‹](https://learnopengl.com/In-Practice/2D-Game/Collisions/Collision-detection)
4. [OpenGLæ¨¡å‹åˆ›å»º](https://learnopengl.com/Getting-started/Hello-Triangle)
5. [Google Poly-3Dæ¨¡å‹åº“](https://poly.google.com)



---